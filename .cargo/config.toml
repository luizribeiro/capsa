[unstable]
bindeps = true

[alias]
clippy-linux = "clippy --workspace --features linux-kvm --exclude capsa-apple-vz --exclude capsa-apple-vzd --exclude capsa-apple-vzd-ipc"
clippy-macos = "clippy --workspace --features macos-native,macos-subprocess,vfkit --exclude capsa-linux-kvm"
test-linux = "test --workspace --features linux-kvm --exclude capsa-apple-vz --exclude capsa-apple-vzd --exclude capsa-apple-vzd-ipc"
test-macos-vfkit = "test --workspace --features vfkit --exclude capsa-linux-kvm"
test-macos-native = "test --workspace --features macos-native --exclude capsa-linux-kvm"
test-macos-subprocess = "test --workspace --features macos-subprocess --exclude capsa-linux-kvm"
bench-linux = "bench --package capsa --features linux-kvm"
bench-macos = "bench --package capsa --features macos-native"

[env]
CAPSA_ENTITLEMENTS = { value = "entitlements.plist", relative = true }

[target.aarch64-apple-darwin]
runner = ["sh", "-c", "exec codesign-run --entitlements \"$CAPSA_ENTITLEMENTS\" \"$@\"", "sh"]

[target.x86_64-apple-darwin]
runner = ["sh", "-c", "exec codesign-run --entitlements \"$CAPSA_ENTITLEMENTS\" \"$@\"", "sh"]
